PROCEDURE DHR6ProcessTrace_FirstTXNDate(
		IN containerIdsList VARCHAR(40000), 
		OUT result CURSOR (
			ModuleContainer varchar (255), 
			Operation varchar (30),
			Resource varchar (30),
			OperatorID varchar (255),
			Workflow varchar (50),
			ERPRouteRev varchar (15),
			WorkflowRev varchar (15),
			TxnDate timestamp,
			WorkCenter varchar (30),
			WrkCtrDesc varchar (255),
			CDOName varchar (37),
			CDODesc varchar (4000),
			ERPRouteName varchar (30),
			OperDesc varchar (255),
			Sequence bigint,
			ONDEFAULTROUTE bigint,
			ZbPosition bigint
      )
    )
    BEGIN
        OPEN result FOR 
			concat(concat('SELECT Distinct
				CONTAINER.ContainerName as ModuleContainer,
				OPERATION.OperationName as Operation,
				RESOURCEDEF.ResourceName as Resource,
				EMPLOYEE.ZBOPERATORID as OperatorID,
				WORKFLOWBASE.WorkflowName as Workflow,
				ERPROUTE.ERPROUTEREVISION as ERPRouteRev,
				WORKFLOW.WorkflowRevision as WorkflowRev,
				HISTORYMAINLINE.TXNDATE as TxnDate,
				WORKCENTER.WorkCenterName as WorkCenter,
				WORKCENTER.Description as WrkCtrDesc,
				CDODEFINITION.CDONAME as CDOName,
				substr(CDODEFINITION.CDODESCRIPTION,1,30) as CDODesc,
				ERPROUTEBASE.ERPROUTENAME as ERPRouteName,
				OPERATION.DESCRIPTION as OperDesc,
				WORKFLOWSTEP.Sequence,
				WORKFLOWSTEP.ONDEFAULTROUTE,
				CONTAINER.ZBPOSITION as ZbPosition
				
				FROM
				/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER
				INNER JOIN  /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF ON HISTORYCROSSREF.TRACKINGID=CONTAINER.CONTAINERID
				INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE ON (HISTORYMAINLINE.HISTORYID=HISTORYCROSSREF.HISTORYID AND HISTORYMAINLINE.TXNID BETWEEN HISTORYCROSSREF.STARTTXNID AND HISTORYCROSSREF.ENDTXNID)
				INNER JOIN /shared/MES7/CommonalityAnalysis/NewViews/Intermediate/FirstHistoryMainLine(containerIdsList) hist_A ON hist_A.HISTORYID = HISTORYMAINLINE.HISTORYID AND hist_A.FirstTXNDATE = HISTORYMAINLINE.TXNDATE
				INNER JOIN/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CDODEFINITION  ON (CDODEFINITION.CDODEFID=HISTORYMAINLINE.TXNTYPE)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOWSTEP  WORKFLOWSTEP ON (WORKFLOWSTEP.WORKFLOWSTEPID=HISTORYMAINLINE.WORKFLOWSTEPID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOW  WORKFLOW ON (WORKFLOW.WORKFLOWID=WORKFLOWSTEP.WORKFLOWID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOWBASE  WORKFLOWBASE ON (WORKFLOWBASE.WORKFLOWBASEID=WORKFLOW.WORKFLOWBASEID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ERPROUTE ON (ERPROUTE.ERPROUTEID=WORKFLOW.ERPROUTEID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ERPROUTEBASE ON (ERPROUTEBASE.ERPROUTEBASEID=ERPROUTE.ERPROUTEBASEID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/EMPLOYEE ON (EMPLOYEE.EMPLOYEEID=HISTORYMAINLINE.EMPLOYEEID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION ON (HISTORYMAINLINE.OPERATIONID=OPERATION.OPERATIONID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKCENTER ON (WORKCENTER.WORKCENTERID=OPERATION.WORKCENTERID)
				LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/RESOURCEDEF  RESOURCEDEF ON (HISTORYMAINLINE.RESOURCEID=RESOURCEDEF.RESOURCEID)
				WHERE CONTAINER.CONTAINERID in (',containerIdsList),')');
    END