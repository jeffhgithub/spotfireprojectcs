SELECT Distinct
  CONTAINER.ContainerName as ModuleContainer, 
  CONTAINER_ISSUED.CONTAINERNAME as ComponentBatch,
  PRODUCTBASE.PRODUCTNAME as Component, 
  PRODUCT.DESCRIPTION as ComponentDesc,
  OPERATION.OperationName as Operation,
  EMPLOYEE.ZBOPERATORID as OperatorID,
  ISSUEACTUALSHISTORY.REFERENCEDESIGNATOR as ReferenceDesignator,
  HISTORYMAINLINE.TXNDATE as TxnDate,
  ISSUEACTUALSHISTORY.Qty as Qty,
  OPERATION.DESCRIPTION as OperDesc,
  ZCINCOMINGDETAIL.ZCVENDORBATCH as VendorBatch,
  CONTAINER.ZBPOSITION as ZbPosition,
CONTAINER.CONTAINERID
FROM
 /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER
    INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF ON (HISTORYCROSSREF.TRACKINGID=CONTAINER.CONTAINERID)
   INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE  HISTORYMAINLINE ON (HISTORYMAINLINE.HISTORYID=HISTORYCROSSREF.HISTORYID AND HISTORYMAINLINE.TXNID BETWEEN HISTORYCROSSREF.STARTTXNID AND HISTORYCROSSREF.ENDTXNID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/COMPONENTISSUEHISTORY ON (COMPONENTISSUEHISTORY.HISTORYMAINLINEID=HISTORYMAINLINE.HISTORYMAINLINEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ISSUEHISTORYDETAIL ON (ISSUEHISTORYDETAIL.COMPONENTISSUEHISTORYID=COMPONENTISSUEHISTORY.COMPONENTISSUEHISTORYID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ISSUEACTUALSHISTORY ON (ISSUEACTUALSHISTORY.ISSUEHISTORYDETAILID=ISSUEHISTORYDETAIL.ISSUEHISTORYDETAILID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT  PRODUCT ON (PRODUCT.PRODUCTID=ISSUEACTUALSHISTORY.PRODUCTID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE  PRODUCTBASE ON (PRODUCTBASE.PRODUCTBASEID=PRODUCT.PRODUCTBASEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER  CONTAINER_ISSUED ON (CONTAINER_ISSUED.CONTAINERID=ISSUEACTUALSHISTORY.FROMCONTAINERID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCINCOMINGDETAIL  ZCINCOMINGDETAIL ON (ZCINCOMINGDETAIL.ZCINCOMINGDETAILID=CONTAINER_ISSUED.ZCINCOMINGDETAILID)
   LEFT OUTER  JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/EMPLOYEE ON (EMPLOYEE.EMPLOYEEID=HISTORYMAINLINE.EMPLOYEEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION ON (HISTORYMAINLINE.OPERATIONID=OPERATION.OPERATIONID)
  
WHERE
CONTAINER.LEVELID = '00052820000000b4' AND 
HISTORYMAINLINE.TXNTYPE in (4719017,4719023,4719024) 


