SELECT Distinct
  CONTAINER.ContainerName as ModuleContainer,
  OPERATION.OperationName as Operation,
  RESOURCEDEF.ResourceName as Resource,
  EMPLOYEE.ZBOPERATORID as OperatorID,
  WORKFLOWBASE.WorkflowName as Workflow,
  ERPROUTE.ERPROUTEREVISION as ERPRouteRev,
  WORKFLOW.WorkflowRevision as WorkflowRev,
  HISTORYMAINLINE.TXNDATE as TxnDate,
  WORKCENTER.WorkCenterName as WorkCenter,
  WORKCENTER.Description as WrkCtrDesc,
  CDODEFINITION.CDONAME as CDOName,
  substr(CDODEFINITION.CDODESCRIPTION,1,30) as CDODesc,
  ERPROUTEBASE.ERPROUTENAME as ERPRouteName,
  OPERATION.DESCRIPTION as OperDesc,
	WORKFLOWSTEP.Sequence,
  WORKFLOWSTEP.ONDEFAULTROUTE,
CONTAINER.ZBPOSITION as ZbPosition,
CONTAINER.CONTAINERID
  
FROM
	/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER
	INNER JOIN  /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF ON HISTORYCROSSREF.TRACKINGID=CONTAINER.CONTAINERID
	INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE ON (HISTORYMAINLINE.HISTORYID=HISTORYCROSSREF.HISTORYID AND HISTORYMAINLINE.TXNID BETWEEN HISTORYCROSSREF.STARTTXNID AND HISTORYCROSSREF.ENDTXNID)
    INNER JOIN/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CDODEFINITION  ON (CDODEFINITION.CDODEFID=HISTORYMAINLINE.TXNTYPE)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOWSTEP  WORKFLOWSTEP ON (WORKFLOWSTEP.WORKFLOWSTEPID=HISTORYMAINLINE.WORKFLOWSTEPID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOW  WORKFLOW ON (WORKFLOW.WORKFLOWID=WORKFLOWSTEP.WORKFLOWID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOWBASE  WORKFLOWBASE ON (WORKFLOWBASE.WORKFLOWBASEID=WORKFLOW.WORKFLOWBASEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ERPROUTE ON (ERPROUTE.ERPROUTEID=WORKFLOW.ERPROUTEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ERPROUTEBASE ON (ERPROUTEBASE.ERPROUTEBASEID=ERPROUTE.ERPROUTEBASEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/EMPLOYEE ON (EMPLOYEE.EMPLOYEEID=HISTORYMAINLINE.EMPLOYEEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION ON (HISTORYMAINLINE.OPERATIONID=OPERATION.OPERATIONID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKCENTER ON (WORKCENTER.WORKCENTERID=OPERATION.WORKCENTERID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/RESOURCEDEF  RESOURCEDEF ON (HISTORYMAINLINE.RESOURCEID=RESOURCEDEF.RESOURCEID)
   

