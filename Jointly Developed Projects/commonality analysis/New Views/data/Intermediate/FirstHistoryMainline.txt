PROCEDURE FirstHistoryMainLine(
    IN containerIdsList VARCHAR(40000), 
    OUT result CURSOR (
        HISTORYID CHAR(16), 
        OPERATIONID CHAR(16), 
        TXNTYPE BIGINT, 
        FirstTXNDATE TIMESTAMP
        )
    )
    BEGIN
        OPEN result FOR 
			concat(concat('
			SELECT 
				HISTORYMAINLINE.HISTORYID, 
				HISTORYMAINLINE.OPERATIONID,
				HISTORYMAINLINE.TXNTYPE,  
				min(HISTORYMAINLINE.TXNDATE) FirstTXNDATE
			FROM 
			/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER      
			INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF ON (HISTORYCROSSREF.TRACKINGID=CONTAINER.CONTAINERID) 
			INNER JOIN  /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE ON (HISTORYMAINLINE.HISTORYID=HISTORYCROSSREF.HISTORYID AND HISTORYMAINLINE.TXNID BETWEEN HISTORYCROSSREF.STARTTXNID AND HISTORYCROSSREF.ENDTXNID)
			WHERE CONTAINER.LEVELID = ''00052820000000b4''  and  CONTAINER.CONTAINERID in (',containerIdsList),')
			GROUP BY 
				HISTORYMAINLINE.OPERATIONID,
				HISTORYMAINLINE.HISTORYID,
				HISTORYMAINLINE.TXNTYPE');
    END