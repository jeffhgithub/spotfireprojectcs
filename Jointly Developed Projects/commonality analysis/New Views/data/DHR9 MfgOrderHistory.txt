SELECT distinct
  MFGORDER.MfgOrderName as MfgOrder,
  CONTAINER.ContainerName as ModuleContainer,
  HistoricalMfgOrderType.DESCRIPTION as HistMfgOrderDesc,
  HistoricalMfgOrderType.ORDERTYPENAME as HistMfgOrderType,
  ORDERTYPE.DESCRIPTION as OrderTypDesc,
  ORDERTYPE.ORDERTYPENAME as OrderType,
  HistoricalMfgOrder.MFGORDERNAME as HistoricalMfgOrder,
  case when ORDERSTATUS.ORDERSTATUSNAME IS NULL THEN 'Open' ELSE ORDERSTATUS.ORDERSTATUSNAME END OrderStatus,
CONTAINER.ZBPOSITION as ZbPosition,
CONTAINER.CONTAINERID
FROM
/shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER
 INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF HISTORYCROSSREF ON (HISTORYCROSSREF.TRACKINGID=CONTAINER.CONTAINERID)
 INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE ON (HISTORYMAINLINE.HISTORYID=HISTORYCROSSREF.HISTORYID AND HISTORYMAINLINE.TXNID BETWEEN HISTORYCROSSREF.STARTTXNID AND HISTORYCROSSREF.ENDTXNID)
  INNER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER ON CONTAINER.MFGORDERID=MFGORDER.MFGORDERID
INNER JOIN  /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ORDERTYPE ON MFGORDER.ORDERTYPEID=ORDERTYPE.ORDERTYPEID
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCCONTAINERMAINTHISTORY ON (HISTORYMAINLINE.HISTORYMAINLINEID=ZCCONTAINERMAINTHISTORY.HISTORYMAINLINEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCCONTAINERMAINTHISTDETAIL ON (ZCCONTAINERMAINTHISTORY.ZCCONTAINERMAINTHISTORYID=ZCCONTAINERMAINTHISTDETAIL.CHGCONTAINERATTRHISTORYID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER  HistoricalMfgOrder ON (ZCCONTAINERMAINTHISTDETAIL.MFGORDERID=HistoricalMfgOrder.MFGORDERID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ORDERTYPE  HistoricalMfgOrderType ON (HistoricalMfgOrder.ORDERTYPEID=HistoricalMfgOrderType.ORDERTYPEID)
   LEFT OUTER JOIN /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ORDERSTATUS ON (MFGORDER.ORDERSTATUSID=ORDERSTATUS.ORDERSTATUSID)
 