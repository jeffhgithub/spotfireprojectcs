SELECT 
    RESOURCEDEF.RESOURCENAME ResourceName, 
    MFGORDER.MFGORDERNAME MfgOrder, 
    CONTAINER.CONTAINERNAME ModuleSN, 
    PRODUCTBASE.PRODUCTNAME Product, 
    PRODUCT.ZBNAMEOLD PartNumber, 
    OPERATION.OPERATIONNAME Operation, 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME TestPlan, 
    ZBTESTPLANHISTORY.ZBTESTPLANEXECUTIONDATE TestPlanExecDate, 
    ZBJUDGEMENTTYPE.ZBJUDGEMENTTYPENAME TestPlanJudgement, 
    ZBTESTHISTORY.ZBTESTNAME RefDes, 
    ZBJUDGEMENTTYPE_1.ZBJUDGEMENTTYPENAME RefDesJudgement, 
    ZBTESTRESULTHISTORY.ZBTESTRESULTNAME Test, 
    ZBTESTRESULTHISTORY.ZBTESTRESULTROWINDEX Index, 
    ZBJUDGEMENTTYPE_2.ZBJUDGEMENTTYPENAME TestResultJudgement, 
    ZBTESTRESULTHISTORY.ZBTESTRESULTVALUE TestResultValue, 
    ZBTESTRESULTDEF.ZBUPPERLIMIT USL, 
    ZBTESTRESULTDEF.ZBLOWERLIMIT LSL, 
    MFGORDER.MFGORDERID, 
    CONTAINER.CONTAINERID, 
    OPERATION.OPERATIONID, 
    PRODUCT.PRODUCTID, 
    RESOURCEDEF.RESOURCEID
FROM      
    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/RESOURCEDEF RESOURCEDEF INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEF ZBTESTPLANDEF RIGHT OUTER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBJUDGEMENTTYPE ZBJUDGEMENTTYPE_1 RIGHT OUTER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBJUDGEMENTTYPE ZBJUDGEMENTTYPE RIGHT OUTER JOIN 
                    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION OPERATION INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT PRODUCT INNER JOIN 
                            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER INNER JOIN 
                                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER CONTAINER INNER JOIN 
                                    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBPRODUCTIONVERSION ZBPRODUCTIONVERSION
                                ON CONTAINER.ZBPRODUCTIONVERSIONID = ZBPRODUCTIONVERSION.ZBPRODUCTIONVERSIONID
                            ON MFGORDER.MFGORDERID = CONTAINER.MFGORDERID
                        ON PRODUCT.PRODUCTID = MFGORDER.PRODUCTID INNER JOIN 
                            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE PRODUCTBASE
                        ON PRODUCT.PRODUCTBASEID = PRODUCTBASE.PRODUCTBASEID INNER JOIN 
                            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF HISTORYCROSSREF
                        ON CONTAINER.CONTAINERID = HISTORYCROSSREF.TRACKINGID INNER JOIN 
                            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE
                        ON (HISTORYCROSSREF.ENDTXNID >= HISTORYMAINLINE.TXNID AND 
                            HISTORYCROSSREF.STARTTXNID <= HISTORYMAINLINE.TXNID) AND 
                            HISTORYCROSSREF.HISTORYID = HISTORYMAINLINE.HISTORYID
                    ON OPERATION.OPERATIONID = HISTORYMAINLINE.OPERATIONID INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANHISTORY ZBTESTPLANHISTORY
                    ON HISTORYMAINLINE.TXNID = ZBTESTPLANHISTORY.TXNID AND 
                        HISTORYMAINLINE.HISTORYID = ZBTESTPLANHISTORY.HISTORYID
                ON ZBJUDGEMENTTYPE.ZBJUDGEMENTTYPEID = ZBTESTPLANHISTORY.ZBJUDGEMENTTYPEID INNER JOIN 
                    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTHISTORY ZBTESTHISTORY
                ON ZBTESTPLANHISTORY.ZBTESTPLANHISTORYID = ZBTESTHISTORY.ZBTESTPLANHISTORYID
            ON ZBJUDGEMENTTYPE_1.ZBJUDGEMENTTYPEID = ZBTESTHISTORY.ZBJUDGEMENTTYPEID INNER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTRESULTHISTORY ZBTESTRESULTHISTORY
            ON ZBTESTHISTORY.ZBTESTHISTORYID = ZBTESTRESULTHISTORY.ZBTESTHISTORYID LEFT OUTER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBJUDGEMENTTYPE ZBJUDGEMENTTYPE_2
            ON ZBTESTRESULTHISTORY.ZBJUDGEMENTTYPEID = ZBJUDGEMENTTYPE_2.ZBJUDGEMENTTYPEID LEFT OUTER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEFBASE ZBTESTPLANDEFBASE
            ON ZBTESTPLANHISTORY.ZBTESTPLANNAME = ZBTESTPLANDEFBASE.ZBTESTPLANDEFNAME
        ON ZBTESTPLANDEF.REVISION = ZBTESTPLANHISTORY.ZBTESTPLANREVISION AND 
            ZBTESTPLANDEFBASE.ZBTESTPLANDEFBASEID = ZBTESTPLANDEF.ZBTESTPLANDEFBASEID LEFT OUTER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTDEF ZBTESTDEF
        ON ZBTESTPLANDEF.ZBTESTPLANDEFID = ZBTESTDEF.ZBTESTPLANDEFID AND 
            ZBTESTHISTORY.ZBTESTNAME = ZBTESTDEF.ZBTESTDEFNAME LEFT OUTER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTRESULTDEF ZBTESTRESULTDEF
        ON ((ZBTESTRESULTHISTORY.ZBTESTRESULTNAME = ZBTESTRESULTDEF.ZBTESTRESULTDEFNAME AND 
            ZBTESTDEF.ZBTESTDEFID = ZBTESTRESULTDEF.ZBTESTDEFID) AND 
            ZBTESTRESULTHISTORY.ZBTESTRESULTCOLINDEX = ZBTESTRESULTDEF.ZBCOLINDEX) AND 
            ZBTESTRESULTHISTORY.ZBTESTRESULTROWINDEX = ZBTESTRESULTDEF.ZBROWINDEX
    ON RESOURCEDEF.RESOURCEID = HISTORYMAINLINE.RESOURCEID
WHERE
    OPERATION.OPERATIONID IN ('00060e2000006ac6', '00060e2000006a72') AND 
    ZBJUDGEMENTTYPE_2.ZBJUDGEMENTTYPENAME = 'Failed'