SELECT DISTINCT 
    MFGORDER.MFGORDERNAME MfgOrder, 
    PRODUCTBASE.PRODUCTNAME Product, 
    PRODUCT.ZBNAMEOLD PartNumber, 
    OPERATION.OPERATIONNAME Operation, 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME TestPlan, 
    CAST(TRUNC(ZBTESTPLANHISTORY.ZBTESTPLANEXECUTIONDATE, 'mm') AS DATE) TestPlanExecDate, 
    MFGORDER.MFGORDERID, 
    OPERATION.OPERATIONID
FROM      
    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION OPERATION INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT PRODUCT INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER INNER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER CONTAINER
            ON MFGORDER.MFGORDERID = CONTAINER.MFGORDERID
        ON PRODUCT.PRODUCTID = MFGORDER.PRODUCTID INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE PRODUCTBASE
        ON PRODUCT.PRODUCTBASEID = PRODUCTBASE.PRODUCTBASEID INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF HISTORYCROSSREF
        ON CONTAINER.CONTAINERID = HISTORYCROSSREF.TRACKINGID INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE
        ON (HISTORYCROSSREF.ENDTXNID >= HISTORYMAINLINE.TXNID AND 
            HISTORYCROSSREF.STARTTXNID <= HISTORYMAINLINE.TXNID) AND 
            HISTORYCROSSREF.HISTORYID = HISTORYMAINLINE.HISTORYID
    ON OPERATION.OPERATIONID = HISTORYMAINLINE.OPERATIONID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANHISTORY ZBTESTPLANHISTORY
    ON HISTORYMAINLINE.TXNID = ZBTESTPLANHISTORY.TXNID AND 
        HISTORYMAINLINE.HISTORYID = ZBTESTPLANHISTORY.HISTORYID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEFBASE ZBTESTPLANDEFBASE
    ON ZBTESTPLANHISTORY.ZBTESTPLANNAME = ZBTESTPLANDEFBASE.ZBTESTPLANDEFNAME LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEF ZBTESTPLANDEF
    ON ZBTESTPLANHISTORY.ZBTESTPLANREVISION = ZBTESTPLANDEF.REVISION AND 
        ZBTESTPLANDEFBASE.ZBTESTPLANDEFBASEID = ZBTESTPLANDEF.ZBTESTPLANDEFBASEID
WHERE
    (((ZBTESTPLANHISTORY.ZBTESTPLANNAME LIKE '%FPT%' OR 
    (ZBTESTPLANHISTORY.ZBTESTPLANNAME LIKE '%FOLD%' AND 
    (ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVNT%' AND 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVENT%'))) OR 
    (ZBTESTPLANHISTORY.ZBTESTPLANNAME LIKE '%FLAT%' AND 
    (ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVNT%' OR 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVENT%'))) AND 
    CAST(TRUNC(ZBTESTPLANHISTORY.ZBTESTPLANEXECUTIONDATE, 'mm') AS DATE) >= '2020-01-01') AND 
    OPERATION.OPERATIONID IN ('00060e20000000c1', '00060e2000000b6a', '00060e40000efdea', '00060e2000000b6c', '00060e2000000b68', '00060e2000005daa', '00060e4000008d08', '00060e2000001b31', '00060e40000efded', '00060e2000000c28', '00060e4000008777', '00060e4000008779', '00060e400000d6f5')