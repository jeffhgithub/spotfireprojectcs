SELECT 
    MFGORDER.MFGORDERNAME, 
    CONTAINER.CONTAINERNAME, 
    Table__759.CONTAINERNAME PanelContainerName, 
    CONTAINERLEVEL.CONTAINERLEVELNAME, 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME, 
    ZBTESTPLANHISTORY.ZBTESTPLANREVISION, 
    Table__431.ZBTESTRESULTNAME, 
    Table__431.ZBTESTRESULTVALUE, 
    Table__430.ZBTESTNAME, 
    CONTAINER.ZBPOSITION, 
    HISTORYMAINLINE.TXNDATE, 
    Table__435.ZBJUDGEMENTTYPENAME, 
    PRODUCTBASE.PRODUCTNAME, 
    PRODUCT.ZBNAMEOLD, 
    PRODUCT.DESCRIPTION, 
    OPERATION.OPERATIONNAME, 
    Table__117.RESOURCENAME, 
    Table__431.ZBTESTRESULTROWINDEX
FROM      
    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINERLEVEL CONTAINERLEVEL INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER CONTAINER
    ON CONTAINER.LEVELID = CONTAINERLEVEL.CONTAINERLEVELID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF HISTORYCROSSREF
    ON HISTORYCROSSREF.TRACKINGID = CONTAINER.CONTAINERID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE Table__370
    ON Table__370.HISTORYID = HISTORYCROSSREF.HISTORYID AND 
        (Table__370.TXNID >= HISTORYCROSSREF.STARTTXNID AND 
        Table__370.TXNID <= HISTORYCROSSREF.ENDTXNID) INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE
    ON ((HISTORYMAINLINE.HISTORYID = Table__370.HISTORYID OR 
        HISTORYMAINLINE.COMMENTS IS NOT NULL) OR 
        HISTORYMAINLINE.TXNTYPE = 4719381) AND 
        HISTORYMAINLINE.TXNID = Table__370.TXNID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION OPERATION
    ON HISTORYMAINLINE.OPERATIONID = OPERATION.OPERATIONID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/RESOURCEDEF Table__117
    ON HISTORYMAINLINE.RESOURCEID = Table__117.RESOURCEID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANHISTORY ZBTESTPLANHISTORY
    ON HISTORYMAINLINE.HISTORYMAINLINEID = ZBTESTPLANHISTORY.HISTORYMAINLINEID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTHISTORY Table__430
    ON ZBTESTPLANHISTORY.ZBTESTPLANHISTORYID = Table__430.ZBTESTPLANHISTORYID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTRESULTHISTORY Table__431
    ON Table__430.ZBTESTHISTORYID = Table__431.ZBTESTHISTORYID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBJUDGEMENTTYPE Table__435
    ON Table__431.ZBJUDGEMENTTYPEID = Table__435.ZBJUDGEMENTTYPEID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT PRODUCT
    ON CONTAINER.PRODUCTID = PRODUCT.PRODUCTID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE PRODUCTBASE
    ON PRODUCT.PRODUCTBASEID = PRODUCTBASE.PRODUCTBASEID OR 
        PRODUCT.PRODUCTID = PRODUCTBASE.REVOFRCDID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER
    ON CONTAINER.MFGORDERID = MFGORDER.MFGORDERID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/STARTHISTORYDETAIL Table__293
    ON CONTAINER.CONTAINERID = Table__293.CONTAINERID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER Table__759
    ON Table__293.ZCROOTPARENTCONTAINERID = Table__759.CONTAINERID
WHERE
    ((Table__431.ZBTESTRESULTNAME IN ('Area', 'Volume', 'Height', 'XOffset', 'YOffset') AND 
    Table__117.CDOTYPEID = 1490) AND 
    OPERATION.OPERATIONNAME LIKE '%SPI%') AND 
    CONTAINERLEVEL.CONTAINERLEVELNAME IN ('ModuleContainer')