SELECT 
    CONTAINER.CONTAINERNAME, 
    PRODUCTBASE.PRODUCTNAME, 
    PRODUCT.ZBNAMEOLD, 
    MFGORDER.MFGORDERNAME, 
    ZCNONCONFORMANCECODE.ZCNONCONFORMANCECODENAME NCR_Code, 
    ZCNONCONFORMANCECODE.DESCRIPTION NCR_Code_Description, 
    ZCFAILUREMODECODE.ZCFAILUREMODECODENAME FailMode_Code, 
    ZCFAILUREMODECODE.DESCRIPTION NCR_FailModeCode_Description, 
    NCR.CREATIONDATE NCR_Create_Date, 
    NCR.ZCNCREFERENCEDESIGNATOR NCR_ReferenceDesignator, 
    NCR.ZCFMREFERENCEDESIGNATOR FailMode_ReferenceDesignator, 
    Table__140.WORKFLOWSTEPNAME, 
    ZCDISPOSITIONCODE.ZCDISPOSITIONCODENAME DispositionCodeName, 
    NCR.NCRCOMMENT, 
    CONTAINER.ZBPOSITION
FROM      
    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINERLEVEL CONTAINERLEVEL INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER CONTAINER
    ON CONTAINER.LEVELID = CONTAINERLEVEL.CONTAINERLEVELID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT PRODUCT
    ON CONTAINER.PRODUCTID = PRODUCT.PRODUCTID INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE PRODUCTBASE
    ON PRODUCT.PRODUCTBASEID = PRODUCTBASE.PRODUCTBASEID OR 
        PRODUCT.PRODUCTID = PRODUCTBASE.REVOFRCDID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER
    ON CONTAINER.MFGORDERID = MFGORDER.MFGORDERID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/NONCONFORMANCEREPORT NCR
    ON CONTAINER.CONTAINERID = NCR.CONTAINERID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/WORKFLOWSTEP Table__140
    ON Table__140.WORKFLOWSTEPID = NCR.CHARGETOSTEPID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCNONCONFORMANCECODE ZCNONCONFORMANCECODE
    ON ZCNONCONFORMANCECODE.ZCNONCONFORMANCECODEID = NCR.ZCNONCONFORMANCECODEID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCFAILUREMODECODE ZCFAILUREMODECODE
    ON ZCFAILUREMODECODE.ZCFAILUREMODECODEID = NCR.ZCFAILUREMODECODEID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZCDISPOSITIONCODE ZCDISPOSITIONCODE
    ON ZCDISPOSITIONCODE.ZCDISPOSITIONCODEID = NCR.ZCDISPOSITIONCODEID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT Table__358
    ON NCR.ZCFAILUREMODEPRODUCTID = Table__358.PRODUCTID LEFT OUTER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE Table__359
    ON Table__359.PRODUCTBASEID = Table__358.PRODUCTBASEID
WHERE
    ((Table__140.WORKFLOWSTEPNAME NOT IN ('9400 Shipment Completed') AND 
    CONTAINERLEVEL.CONTAINERLEVELNAME = 'ModuleContainer') AND 
    CONTAINER.CONTAINERNAME NOT LIKE '40C%') AND 
    CONTAINER.CONTAINERNAME NOT LIKE '4A%'