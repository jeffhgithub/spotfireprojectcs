SELECT DISTINCT 
    CAST(ZBTESTPLANHISTORY.ZBTESTPLANEXECUTIONDATE AS DATE) TestPlanExecDate, 
    MFGORDER.MFGORDERNAME MfgOrder, 
    PRODUCTBASE.PRODUCTNAME SAPPartNumber, 
    PRODUCT.ZBNAMEOLD Product, 
    ZBTESTPLANDEFBASE.ZBTESTPLANDEFNAME TestPlan, 
    ZBTESTDEF.ZBTESTDEFNAME TestGroupOrRefDes, 
    ZBTESTRESULTDEF.ZBTESTRESULTDEFNAME Test, 
    OPERATION.OPERATIONNAME Operation, 
    PRODUCT.PRODUCTID, 
    PRODUCTBASE.PRODUCTBASEID, 
    MFGORDER.MFGORDERID, 
    OPERATION.OPERATIONID
FROM      
    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/OPERATION OPERATION INNER JOIN 
        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCT PRODUCT INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/CONTAINER CONTAINER INNER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYMAINLINE HISTORYMAINLINE INNER JOIN 
                    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEFBASE ZBTESTPLANDEFBASE INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANDEF ZBTESTPLANDEF
                    ON ZBTESTPLANDEFBASE.ZBTESTPLANDEFBASEID = ZBTESTPLANDEF.ZBTESTPLANDEFBASEID INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTDEF ZBTESTDEF
                    ON ZBTESTPLANDEF.ZBTESTPLANDEFID = ZBTESTDEF.ZBTESTPLANDEFID INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTRESULTDEF ZBTESTRESULTDEF
                    ON ZBTESTDEF.ZBTESTDEFID = ZBTESTRESULTDEF.ZBTESTDEFID INNER JOIN 
                        /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/ZBTESTPLANHISTORY ZBTESTPLANHISTORY
                    ON ZBTESTPLANDEF.REVISION = ZBTESTPLANHISTORY.ZBTESTPLANREVISION AND 
                        ZBTESTPLANHISTORY.ZBTESTPLANNAME = ZBTESTPLANDEFBASE.ZBTESTPLANDEFNAME
                ON HISTORYMAINLINE.HISTORYID = ZBTESTPLANHISTORY.HISTORYID AND 
                    HISTORYMAINLINE.TXNID = ZBTESTPLANHISTORY.TXNID INNER JOIN 
                    /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/HISTORYCROSSREF HISTORYCROSSREF
                ON (HISTORYMAINLINE.HISTORYID = HISTORYCROSSREF.HISTORYID AND 
                    HISTORYMAINLINE.TXNID >= HISTORYCROSSREF.STARTTXNID) AND 
                    HISTORYMAINLINE.TXNID <= HISTORYCROSSREF.ENDTXNID
            ON CONTAINER.CONTAINERID = HISTORYCROSSREF.TRACKINGID INNER JOIN 
                /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/MFGORDER MFGORDER
            ON CONTAINER.MFGORDERID = MFGORDER.MFGORDERID
        ON PRODUCT.PRODUCTID = MFGORDER.PRODUCTID INNER JOIN 
            /shared/MES7/MES7PRD/MES7PRD_LMT_TMP_RO/PRODUCTBASE PRODUCTBASE
        ON PRODUCT.PRODUCTBASEID = PRODUCTBASE.PRODUCTBASEID
    ON HISTORYMAINLINE.OPERATIONID = OPERATION.OPERATIONID
WHERE
    (ZBTESTPLANHISTORY.ZBTESTPLANEXECUTIONDATE >= '2019-01-01 00:00:00' AND 
    (ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVNT%' OR 
    ZBTESTPLANHISTORY.ZBTESTPLANNAME NOT LIKE '%EVENT%')) AND 
    OPERATION.OPERATIONID IN ('00060e2000006a72', '00060e2000006ac6')